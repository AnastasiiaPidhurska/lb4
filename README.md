# üß† –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞ —Ä–æ–±–æ—Ç–∞ ‚Ññ4  
## –°–∏–≥–Ω–∞–ª–∏ ‚Äî —Ç—Ä–∞–¥–∏—Ü—ñ–π–Ω—ñ –∑–∞—Å–æ–±–∏ –≤–∑–∞—î–º–æ–¥—ñ—ó –ø—Ä–æ—Ü–µ—Å—ñ–≤  
**–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞:** –û–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ —Å–∏—Å—Ç–µ–º–∏ (Linux API)  
**–ú–µ—Ç–∞:** –î–æ—Å–ª—ñ–¥–∏—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º —Å–∏–≥–Ω–∞–ª—ñ–≤ —É Linux, –Ω–∞–≤—á–∏—Ç–∏—Å—è –æ–±—Ä–æ–±–ª—è—Ç–∏ —Å–∏–≥–Ω–∞–ª–∏, —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –¥–µ–º–æ–Ω-–ø—Ä–æ—Ü–µ—Å–∏ —Ç–∞ —Ä–µ–∞–ª—ñ–∑–æ–≤—É–≤–∞—Ç–∏ –≤–∑–∞—î–º–æ–¥—ñ—é –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é —Å–∏–≥–Ω–∞–ª—ñ–≤.

---

## ‚öôÔ∏è –ó–∞–≤–¥–∞–Ω–Ω—è 1 ‚Äî –û–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—É –≤–≤–µ–¥–µ–Ω–Ω—è (`SIGALRM` + `alarm()`)

### üìò –û–ø–∏—Å
–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –∫–æ–Ω—Å–æ–ª—å–Ω—É –ø—Ä–æ–≥—Ä–∞–º—É, —â–æ –æ–±–º–µ–∂—É—î —á–∞—Å –≤–≤–µ–¥–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–º –¥–∞–Ω–∏—Ö (–ü–Ü–ë, email, –≤—ñ–∫).  
–Ø–∫—â–æ —á–∞—Å –≤–∏—á–µ—Ä–ø–∞–Ω–æ, –ø—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–≤–µ—Ä—à—É—î—Ç—å—Å—è –∑ –∫–æ–¥–æ–º `124` —ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º.

### üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞
lab4-task1/
‚îú‚îÄ include/timer.h
‚îú‚îÄ src/timer.c
‚îú‚îÄ src/main.c
‚îú‚îÄ Makefile

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥

### üöÄ –ó–∞–ø—É—Å–∫
```bash
make
./build/task1 -t 10
–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:

-t, --timeout <—Å–µ–∫> ‚Äî –ª—ñ–º—ñ—Ç —á–∞—Å—É –Ω–∞ –≤–≤–µ–¥–µ–Ω–Ω—è (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º 15 —Å).

üíª –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É
ruby
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ (—Ç–∞–π–º-–∞—É—Ç –Ω–∞ –ø–æ–ª–µ: 5 —Å)
–©–æ–± –≤–∏–π—Ç–∏ ‚Äî –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å Ctrl+D.

–í–≤–µ–¥—ñ—Ç—å –ü–Ü–ë: ‚è≥ –ß–∞—Å –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è –≤–≤–µ–¥–µ–Ω–Ω—è –≤–∏—á–µ—Ä–ø–∞–Ω–æ. –°–ø—Ä–æ–±—É–π—Ç–µ –∑–Ω–æ–≤—É –∞–±–æ –∑–±—ñ–ª—å—à—Ç–µ –ª—ñ–º—ñ—Ç (-t).
$ echo $?
124
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç
–°–∏–≥–Ω–∞–ª SIGALRM –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é —á–∞—Å—É.

–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ —Å–∫–∞—Å—É–≤–∞–Ω–Ω—è —Ç–∞–π–º–µ—Ä–∞ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ sigaction() —ñ alarm().

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ-–±–µ–∑–ø–µ—á–Ω—É —Ñ—É–Ω–∫—Ü—ñ—é write() —É —Å–∏–≥–Ω–∞–ª—å–Ω–æ–º—É –æ–±—Ä–æ–±–Ω–∏–∫—É.

‚öôÔ∏è –ó–∞–≤–¥–∞–Ω–Ω—è 2 ‚Äî –î–µ–º–æ–Ω, —â–æ —Ä–µ–∞–≥—É—î –Ω–∞ —Å–∏–≥–Ω–∞–ª–∏ (SIGHUP, SIGTERM)
üìò –û–ø–∏—Å
–°—Ç–≤–æ—Ä–µ–Ω–æ –¥–µ–º–æ–Ω-–ø—Ä–æ—Ü–µ—Å, —è–∫–∏–π:

–ø—Ä–∞—Ü—é—î —É —Ñ–æ–Ω–æ–≤–æ–º—É —Ä–µ–∂–∏–º—ñ;

—á–∏—Ç–∞—î —Ñ–∞–π–ª config.txt, —â–æ –º—ñ—Å—Ç–∏—Ç—å —Å–∏–º–≤–æ–ª —ñ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ–≤—Ç–æ—Ä—ñ–≤;

–∫–æ–∂–Ω—ñ 3 —Å–µ–∫—É–Ω–¥–∏ –∑–∞–ø–∏—Å—É—î —É –ª–æ–≥ (/tmp/lab4_task2.log) —Ü–µ–π —Å–∏–º–≤–æ–ª —É –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ–π –∫—ñ–ª—å–∫–æ—Å—Ç—ñ;

–ø—Ä–∏ SIGHUP –ø–µ—Ä–µ—á–∏—Ç—É—î –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª;

–ø—Ä–∏ SIGTERM –∑–∞–≤–µ—Ä—à—É—î —Ä–æ–±–æ—Ç—É.

üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
lab4-task2/
‚îú‚îÄ include/daemon_app.h
‚îú‚îÄ src/daemon_app.c
‚îú‚îÄ src/main.c
‚îú‚îÄ config.txt
‚îú‚îÄ Makefile
üìÑ config.txt (–ø—Ä–∏–∫–ª–∞–¥)
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
#
5
üöÄ –ó–∞–ø—É—Å–∫
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
make
./build/task2 &
tail -f /tmp/lab4_task2.log
–ö–æ–∂–Ω—ñ 3 —Å–µ–∫—É–Ω–¥–∏ –∑‚Äô—è–≤–ª—è—Ç–∏–º—É—Ç—å—Å—è —Ä—è–¥–∫–∏ –∑ *.

üîÑ –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥:
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
nano config.txt
# –∑–º—ñ–Ω–∏—Ç–∏ –Ω–∞:
$
3
kill -HUP $(pgrep task2)
üõë –ó–∞–≤–µ—Ä—à–∏—Ç–∏ –¥–µ–º–æ–Ω:
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
kill -TERM $(pgrep task2)
üíª –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É (tail -f /tmp/lab4_task2.log)
ruby
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
*****
*****
*****
[INFO] Config reloaded: symbol=$ repeat=3
$$$
$$$
[INFO] Terminated
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü—Ä–æ—Ü–µ—Å –ø—Ä–∞—Ü—é—î —É —Ñ–æ–Ω—ñ (–¥–µ–º–æ–Ω—ñ–∑–∞—Ü—ñ—è: fork(), setsid(), umask(0), chdir("/")).

–†–µ–∞–≥—É—î –Ω–∞ —Å–∏–≥–Ω–∞–ª–∏ SIGHUP (–ø–µ—Ä–µ—á–∏—Ç—É—î –∫–æ–Ω—Ñ—ñ–≥) —Ç–∞ SIGTERM (–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è).

–õ–æ–≥–∏ –≤–µ–¥—É—Ç—å—Å—è —É /tmp/lab4_task2.log.

‚öôÔ∏è –ó–∞–≤–¥–∞–Ω–Ω—è 3 ‚Äî –í–∑–∞—î–º–æ–¥—ñ—è –ø—Ä–æ—Ü–µ—Å—ñ–≤ —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É
üìò –û–ø–∏—Å
–ü—Ä–æ–≥—Ä–∞–º–∞ —Å—Ç–≤–æ—Ä—é—î –±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π —ñ –¥–æ—á—ñ—Ä–Ω—ñ–π –ø—Ä–æ—Ü–µ—Å–∏, —è–∫—ñ –æ–±–º—ñ–Ω—é—é—Ç—å—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É (SIGRTMIN).

–ë–∞—Ç—å–∫—ñ–≤—Å—å–∫–∏–π –ø—Ä–æ—Ü–µ—Å –Ω–∞–¥—Å–∏–ª–∞—î —Å–∏–≥–Ω–∞–ª —á–µ—Ä–µ–∑ sigqueue(), –ø–µ—Ä–µ–¥–∞—é—á–∏ –Ω–æ–º–µ—Ä –≤–∏–∫–ª–∏–∫—É.

–î–æ—á—ñ—Ä–Ω—ñ–π –ø—Ä–æ—Ü–µ—Å –æ–±—Ä–æ–±–ª—è—î —Å–∏–≥–Ω–∞–ª —ñ –≤–∏–≤–æ–¥–∏—Ç—å –π–æ–≥–æ –Ω–æ–º–µ—Ä, —ñ–º‚Äô—è —Ç–∞ –æ—Ç—Ä–∏–º–∞–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è.

üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
lab4-task3/
‚îú‚îÄ include/sync_signals.h
‚îú‚îÄ src/sync_signals.c
‚îú‚îÄ src/main.c
‚îú‚îÄ Makefile
üöÄ –ó–∞–ø—É—Å–∫
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
make
./build/task3
üíª –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É
sql
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
[CHILD] PID = 7321, –æ—á—ñ–∫—É—é —Å–∏–≥–Ω–∞–ª–∏...
[PARENT] PID = 7320, –Ω–∞—â–∞–¥–æ–∫ PID = 7321
[PARENT] –ù–∞–¥—ñ—Å–ª–∞–Ω–æ —Å–∏–≥–Ω–∞–ª 34 (Real-time signal 0) —ñ–∑ –∑–Ω–∞—á–µ–Ω–Ω—è–º 1
[CHILD] –û—Ç—Ä–∏–º–∞–Ω–æ —Å–∏–≥–Ω–∞–ª 34 (Real-time signal 0), –∑–Ω–∞—á–µ–Ω–Ω—è: 1
[PARENT] –ù–∞–¥—ñ—Å–ª–∞–Ω–æ —Å–∏–≥–Ω–∞–ª 34 (Real-time signal 0) —ñ–∑ –∑–Ω–∞—á–µ–Ω–Ω—è–º 2
[CHILD] –û—Ç—Ä–∏–º–∞–Ω–æ —Å–∏–≥–Ω–∞–ª 34 (Real-time signal 0), –∑–Ω–∞—á–µ–Ω–Ω—è: 2
...
[PARENT] –ó–∞–≤–µ—Ä—à–∏–≤ —Ä–æ–±–æ—Ç—É –¥–æ—á—ñ—Ä–Ω—å–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—É.
‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç
–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ sigaction() –∑ –ø—Ä–∞–ø–æ—Ä–æ–º SA_SIGINFO –¥–ª—è –æ–±—Ä–æ–±–∫–∏ siginfo_t.

–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ sigqueue() –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ –¥–∞–Ω–∏—Ö –º—ñ–∂ –ø—Ä–æ—Ü–µ—Å–∞–º–∏.

–î–æ—á—ñ—Ä–Ω—ñ–π –ø—Ä–æ—Ü–µ—Å –∫–æ—Ä–µ–∫—Ç–Ω–æ –≤–∏–≤–æ–¥–∏—Ç—å –Ω–æ–º–µ—Ä —Å–∏–≥–Ω–∞–ª—É, –π–æ–≥–æ —ñ–º‚Äô—è —Ç–∞ –∑–Ω–∞—á–µ–Ω–Ω—è.

üìã –í–∏—Å–Ω–æ–≤–∫–∏
–£ —Ö–æ–¥—ñ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ—ó —Ä–æ–±–æ—Ç–∏:

–¥–æ—Å–ª—ñ–¥–∂–µ–Ω–æ –º–µ—Ö–∞–Ω—ñ–∑–º–∏ —Å–∏–≥–Ω–∞–ª—ñ–≤ —É Linux;

—Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ:

–ø—Ä–æ–≥—Ä–∞–º—É –∑ —Ç–∞–π–º-–∞—É—Ç–æ–º –≤–≤–µ–¥–µ–Ω–Ω—è (SIGALRM);

–¥–µ–º–æ–Ω, —â–æ —Ä–µ–∞–≥—É—î –Ω–∞ —Å–∏–≥–Ω–∞–ª–∏ (SIGHUP, SIGTERM);

–≤–∑–∞—î–º–æ–¥—ñ—é –ø—Ä–æ—Ü–µ—Å—ñ–≤ —á–µ—Ä–µ–∑ —Å–∏–≥–Ω–∞–ª–∏ —Ä–µ–∞–ª—å–Ω–æ–≥–æ —á–∞—Å—É (SIGRTMIN);

–æ—Ç—Ä–∏–º–∞–Ω–æ –ø—Ä–∞–∫—Ç–∏—á–Ω—ñ –Ω–∞–≤–∏—á–∫–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è sigaction(), sigqueue(), alarm(), fork() —Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –¥–µ–º–æ–Ω—ñ–≤.